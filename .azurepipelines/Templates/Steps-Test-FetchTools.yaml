steps:
  - script: |
      dotnet ezpipeline.dll fetch-tool -n Butler -o $(Build.SourcesDirectory)/tools/ --path
    workingDirectory: $(Build.SourcesDirectory)/nuget/tools/net6.0/any/
    displayName: Fetch Butler

  - script: |
      butler help
    workingDirectory: $(Build.SourcesDirectory)
    displayName: Run Butler

  - script: |
      dotnet ezpipeline.dll fetch-tool -n Ninja -o $(Build.SourcesDirectory)/tools/ --path
    workingDirectory: $(Build.SourcesDirectory)/nuget/tools/net6.0/any/
    displayName: Fetch Ninja


  - script: |
      ninja --version
    workingDirectory: $(Build.SourcesDirectory)
    displayName: Run Ninja

  - script: |
      dotnet ezpipeline.dll fetch-tool -n CMake -o $(Build.SourcesDirectory)/tools/ --path --version 3.27.6
    workingDirectory: $(Build.SourcesDirectory)/nuget/tools/net6.0/any/
    displayName: Fetch CMake

  - pwsh: |
      $output = cmake --version | Select-Object -First 1
      Write-Host $output
      $expected = "cmake version 3.27.6"
      if (-not $output.StartsWith($expected)) {
          Write-Error "Output $output does not match expected value $expected."
          exit 1
      }
    workingDirectory: $(Build.SourcesDirectory)
    displayName: Run CMake


  - script: |
      dotnet ezpipeline.dll fetch-tool -n CMake -o $(Build.SourcesDirectory)/tools/ --path --version 3.19.7
    workingDirectory: $(Build.SourcesDirectory)/nuget/tools/net6.0/any/
    displayName: Fetch CMake

  - pwsh: |
      $output = cmake --version | Select-Object -First 1
      Write-Host $output
      $expected = "cmake version 3.19.7"
      if (-not $output.StartsWith($expected)) {
          Write-Error "Output $output does not match expected value $expected."
          exit 1
      }
    workingDirectory: $(Build.SourcesDirectory)
    displayName: Run CMake

